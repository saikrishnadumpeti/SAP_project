TYPES : BEGIN OF TY_EMPLOYEE,
          EMP_ID     TYPE ZEMPLOYEE_ID_DATA_ELEMENT_8_10,
          EMP_NAME   TYPE ZEMPLOYEE_NAME_DE_8_10,
          DEPARTMENT TYPE ZDEPARTMENT_DE_8_10,
          MANAGER    TYPE ZMANAGER_DE_8_10,
        END OF TY_EMPLOYEE.

TYPES : BEGIN OF TY_PROJECT,
          EMP_ID       TYPE ZEMPLOYEE_ID_DATA_ELEMENT_8_10,
          PROJECT_ID   TYPE ZPROJECT_ID_DE_8_10,
          PROJECT_NAME TYPE ZPROJECT_NAME_DE_8_10,
        END OF TY_PROJECT.

TYPES : BEGIN OF TY_FINAL,
          EMP_ID       TYPE ZEMPLOYEE_ID_DATA_ELEMENT_8_10,
          EMP_NAME     TYPE ZEMPLOYEE_NAME_DE_8_10,
          DEPARTMENT   TYPE ZDEPARTMENT_DE_8_10,
          MANAGER      TYPE ZMANAGER_DE_8_10,
          PROJECT_ID   TYPE ZPROJECT_ID_DE_8_10,
          PROJECT_NAME TYPE ZPROJECT_NAME_DE_8_10,
        END OF TY_FINAL.


DATA : LT_EMPLOYEE TYPE TABLE OF TY_EMPLOYEE,
       LS_EMPLOYEE TYPE TY_EMPLOYEE.
DATA : LT_PROJECT TYPE TABLE OF TY_PROJECT,
       LS_PROJECT TYPE TY_PROJECT.
DATA : LT_FINAL TYPE TABLE OF TY_FINAL,
       LS_FINAL TYPE TY_FINAL.


DATA : LV_EMP_ID TYPE ZEMPLOYEE_ID_DATA_ELEMENT_8_10.
SELECT-OPTIONS : S_EMP_ID FOR LV_EMP_ID.

SELECT : EMP_ID  EMP_NAME   DEPARTMENT MANAGER
 FROM ZEMP_TAB_8_10
 INTO TABLE LT_EMPLOYEE
 WHERE EMP_ID IN S_EMP_ID.

IF SY-SUBRC IS NOT INITIAL.
  SELECT EMP_ID PROJECT_ID PROJECT_NAME
    FROM ZPROJCT_TAB_8_10
   INTO TABLE LT_PROJECT
   FOR ALL ENTRIES IN LT_EMPLOYEE
   WHERE EMP_ID = LT_EMPLOYEE-EMP_ID.

ENDIF.

LOOP AT LT_EMPLOYEE INTO LS_EMPLOYEE.
  LOOP AT LT_PROJECT INTO LS_PROJECT WHERE EMP_ID = LS_EMPLOYEE-EMP_ID.
    LS_FINAL-EMP_ID = LS_EMPLOYEE-EMP_ID.
    LS_FINAL-EMP_NAME = LS_EMPLOYEE-EMP_NAME.
    LS_FINAL-DEPARTMENT = LS_EMPLOYEE-DEPARTMENT.
    LS_FINAL-MANAGER = LS_EMPLOYEE-MANAGER.
    LS_FINAL-PROJECT_ID = LS_PROJECT-PROJECT_ID.
    LS_FINAL-PROJECT_NAME = LS_PROJECT-PROJECT_NAME.
    APPEND LS_FINAL TO LT_FINAL.
    CLEAR LS_FINAL.


  ENDLOOP.
ENDLOOP.

LOOP AT LT_FINAL INTO LS_FINAL.
  WRITE: / LS_FINAL-EMP_ID, LS_FINAL-EMP_NAME,  LS_FINAL-DEPARTMENT,LS_FINAL-MANAGER,  LS_FINAL-PROJECT_ID, LS_FINAL-PROJECT_NAME.


ENDLOOP.