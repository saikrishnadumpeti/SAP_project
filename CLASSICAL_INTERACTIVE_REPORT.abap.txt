REPORT ZCLASSICAL_INTERACTIVE_REPORTS.

INCLUDE ZINCLUDE_MODULARIZATION.

SELECT  EMP_ID   EMP_NAME DEPARTMENT MANAGER
    FROM ZEMP_TAB_8_10
    INTO TABLE LT_EMPLOYEE
    WHERE EMP_ID IN S_EMP_ID.


LOOP AT LT_EMPLOYEE INTO LS_EMPLOYEE.
  WRITE: / LS_EMPLOYEE-EMP_ID, LS_EMPLOYEE-EMP_NAME,LS_EMPLOYEE-DEPARTMENT, LS_EMPLOYEE-MANAGER.
ENDLOOP.

*SET PF-STATUS'FUNCTION'.

AT LINE-SELECTION.

 SELECT  EMP_ID PROJECT_ID PROJECT_NAME
  FROM ZPROJCT_TAB_8_10
  INTO TABLE LT_PROJECT
  WHERE EMP_ID = SY-LISEL+0(3).

LOOP AT LT_PROJECT INTO LS_PROJECT.
  WRITE: / LS_PROJECT-EMP_ID, LS_PROJECT-PROJECT_ID, LS_PROJECT-PROJECT_NAME.
ENDLOOP.

AT USER-COMMAND.

IF SY-UCOMM = 'BACK'.
 LEAVE TO SCREEN 0.
ENDIF.

IF SY-UCOMM = 'ASCENDING'.
 SORT LT_EMPLOYEE BY EMP_ID ASCENDING.
LOOP AT LT_EMPLOYEE INTO LS_EMPLOYEE.
  WRITE: / LS_EMPLOYEE-EMP_ID, LS_EMPLOYEE-EMP_NAME,LS_EMPLOYEE-DEPARTMENT, LS_EMPLOYEE-MANAGER.
ENDLOOP.
ENDIF.

IF SY-UCOMM = 'DESCENDING'.
 SORT LT_EMPLOYEE BY EMP_ID DESCENDING.
LOOP AT LT_EMPLOYEE INTO LS_EMPLOYEE.
  WRITE: / LS_EMPLOYEE-EMP_ID, LS_EMPLOYEE-EMP_NAME,LS_EMPLOYEE-DEPARTMENT, LS_EMPLOYEE-MANAGER.
ENDLOOP.
ENDIF.

TOP-OF-PAGE DURING LINE-SELECTION.
WRITE 'PROJECT DETAILS'.
